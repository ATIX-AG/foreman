<%#
kind: finish
name: AutoYaST orcharhino finish
model: ProvisioningTemplate
oses:
- SLES
-%>
<%
  # safemode renderer does not support unary negation
  pm_set = @host.puppetmaster.empty? ? false : true
  puppet_enabled = pm_set || host_param_true?('force-puppet')
  salt_enabled = host_param('salt_master') ? true : false
-%>

/usr/bin/hostnamectl set-hostname <%= @host.name %>

<%= snippet 'or_sles_client' %>

<%= snippet('remote_execution_ssh_keys') %>

<%= snippet "blacklist_kernel_modules" %>

<% if puppet_enabled -%>
<%= snippet 'puppet_setup' %>
<% end -%>

<% if salt_enabled %>
<%= snippet 'saltstack_setup' %>
<% end -%>

<% if @host.respond_to?(:bootdisk_build?) && @host.bootdisk_build? -%>
eject -v
<% end -%>

<%= snippet 'built' %>
